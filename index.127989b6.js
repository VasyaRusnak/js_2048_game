const t=new class{constructor(t=4){this.size=t,this.score=0,this.status="idle",this.board=this.createBoard()}createBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}start(){this.score=0,this.status="playing",this.board=this.createBoard(),this.addRandomTile(),this.addRandomTile()}restart(){this.start()}getBoard(){return this.board}getScore(){return this.score}getStatus(){return this.status}slideAndCombineRow(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);for(e=e.filter(t=>0!==t);e.length<this.size;)e.push(0);return e}moveLeft(){let t=!1;for(let e=0;e<this.size;e++){let s=this.slideAndCombineRow(this.board[e]);!t&&s.some((t,s)=>t!==this.board[e][s])&&(t=!0),this.board[e]=s}t&&this.addRandomTile(),this.checkStatus()}moveRight(){let t=!1;for(let e=0;e<this.size;e++){let s=this.slideAndCombineRow(this.board[e].slice().reverse()).reverse();!t&&s.some((t,s)=>t!==this.board[e][s])&&(t=!0),this.board[e]=s}t&&this.addRandomTile(),this.checkStatus()}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}transpose(){this.board=this.board[0].map((t,e)=>this.board.map(t=>t[e]))}checkStatus(){if(this.board.flat().includes(2048)){this.status="win";return}this.canMove()||(this.status="lose")}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push({r:e,c:s});if(!t.length)return;let{r:e,c:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.1>Math.random()?4:2}canMove(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0===this.board[t][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1]||t<this.size-1&&this.board[t][e]===this.board[t+1][e])return!0;return!1}},e=document.querySelectorAll(".field-cell"),s=document.querySelector(".game-score"),r=document.querySelector(".start"),i=document.querySelector(".message-start"),o=document.querySelector(".message-win"),a=document.querySelector(".message-lose");function h(){let h=t.getBoard();e.forEach((t,e)=>{let s=h[Math.floor(e/4)][e%4];t.textContent=0===s?"":s,t.className="field-cell"+(s?` field-cell--${s}`:"")}),s.textContent=t.getScore(),i.classList.toggle("hidden","idle"!==t.getStatus()),o.classList.toggle("hidden","win"!==t.getStatus()),a.classList.toggle("hidden","lose"!==t.getStatus()),"idle"===t.getStatus()?(r.textContent="Start",r.classList.add("start"),r.classList.remove("restart")):(r.textContent="Restart",r.classList.remove("start"),r.classList.add("restart"))}r.addEventListener("click",()=>{"idle"===t.getStatus()?t.start():t.restart(),h()}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}h()}}),h();
//# sourceMappingURL=index.127989b6.js.map
